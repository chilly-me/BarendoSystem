{% load static %}

<div class="align-content-center position-sticky top-0 overflow-visible"
     style="height: 80px; background-color: #ffffff; z-index: 1000; width: 100%; position: relative;">
    <nav class="navbar navbar-expand-lg navbar-light">
        <div class="container px-2 d-flex align-items-center">

            <!-- Logo on the far left -->
            <a class="navbar-brand me-auto" href="{% url 'CAuthentication:home' %}">
                <img src="{% static 'img/Screenshot__47_-removebg-preview.png' %}" alt="..." class="logo_image">
            </a>

            <!-- Navbar Toggler with Green Shadow -->
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
                    data-bs-target="#navbarSupportedContent"
                    aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>

            <!-- Collapsible Navigation -->
            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <!-- Close Button (Small Screens Only) -->
                <div class="d-flex justify-content-end p-2 pb-3">
                    <button class="close-nav" type="button" data-bs-toggle="collapse"
                            data-bs-target="#navbarSupportedContent">
                        <i class="bi bi-x-circle" style="color:green;"></i>
                    </button>
                </div>

                <div class="container-fluid d-flex flex-column flex-lg-row align-items-md-start">
                    <!-- Navigation Links (Centered on Large Screens) -->
                    <ul class="navbar-nav mx-auto mb-2 mb-lg-0">
                        <li class="nav-item me-md-4 product-link">
                            <a class="nav-link active nav_item_text d-flex justify-content-between align-items-center"
                               href="{% url 'store:store' %}">
                                Products
                                <img src="{% static 'svg/solar-panel-in-sunlight-svgrepo-com (2).svg' %}" alt="...">
                            </a>
                        </li>
                        <li class="nav-item me-md-4">
                            <a class="nav-link active nav_item_text d-flex justify-content-between align-items-center"
                               href="#">
                                Plans & Pricing
                                <img src="{% static 'svg/price-ui-svgrepo-com.svg' %}"
                                     alt="..."/>
                            </a>
                        </li>
                        <li class="nav-item me-md-4">
                            <a class="nav-link active nav_item_text d-flex justify-content-between align-items-center"
                               href="#">
                                Explore
                                <img src="{% static 'svg/explore-svgrepo-com (1).svg' %}" alt="..."/>
                            </a>
                        </li>
                        <li class="nav-item me-md-4">
                            <a class="nav-link active nav_item_text d-flex justify-content-between align-items-center"
                               href="#">
                                Learn
                                <img src="{% static 'svg/learn-svgrepo-com.svg' %}"
                                     alt="..."/>
                            </a>
                        </li>
                        <li class="nav-item me-md-4 dropdown">
                            <a class="nav-link active nav_item_text d-flex justify-content-between align-items-center"
                               href="#"  id="AccountDropdownMenu" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                                Account
                                <img src="{% static 'svg/account-avatar-person-svgrepo-com.svg' %}"
                                     alt="..."/>
                            </a>
                            <ul class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink" style="position: absolute; z-index: 800;">
                                {% if user.is_authenticated %}
                                <li><a class="dropdown-item" href="" >Account Settings</a></li>
                                <hr class="my-1 py-0">
                                <li><a class="dropdown-item" href="{% url 'CAuthentication:logout' %}" style="text-decoration: none; color: red;">Logout</a></li>
                                <hr class="my-1 py-0">
                                {% else %}
                                <li><a class="dropdown-item" href="{% url 'account_login' %}" style="text-decoration: none;">Login</a></li>
                                <hr class="my-1 py-0">
                                <li><a class="dropdown-item" href="{% url 'account_signup' %}" style="text-decoration: none;">Signup</a></li>
                                <hr class="my-1 py-0">
                                {% endif %}
                            </ul>
                        </li>
                        {% if user.is_superuser %}
                        <li class="nav-item dropdown">
                            <a class="nav-link active nav_item_text d-flex justify-content-between align-items-center" href="#" id="navbarDropdownMenuLink" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                                Admin
                                <img src="{% static 'svg/account-settings-svgrepo-com.svg' %}"
                                     alt="..."/>
                            </a>
                            <ul class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink" style="position: absolute; z-index: 800;">
                                <li class="dropdown-submenu position-relative">
                                    <a class="dropdown-item dropdown-toggle" href="#" id="pendingOrdersDropdown" role="button">
                                        Pending Orders
                                    </a>
                                    <ul class="dropdown-menu">
                                        <li><a class="dropdown-item" href="{% url 'order:pre-paid-pending-orders' %}">Pre-paid Orders</a></li>
                                        <li><a class="dropdown-item" href="{% url 'order:pay-on-delivery-pending-orders' %}">Pay-on-Delivery</a></li>
                                    </ul>
                                </li>
                                <hr class="my-1 py-0">
                                <li><a class="dropdown-item" href="{% url 'order:cancelled-orders' %}">Cancelled Orders</a></li>
                                <hr class="my-1 py-0">
                                <li><a class="dropdown-item" href="{% url 'order:shipped-orders' %}">Shipped Orders</a></li>
                                <hr class="my-1 py-0">
                                <li><a class="dropdown-item" href="#">Delivered Orders</a></li>
                            </ul>
                        </li>
                        {% endif %}

                    </ul>


                    <!-- "Get a Quote" Button -->
                    <div class="quote-btn-container ms-lg-auto">
                        <a href="#">
                            <button class="curved-button">Get a Quote</button>
                        </a>
                    </div>
                </div>
            </div>

        </div>
    </nav>
</div>

<!-- Custom Styles -->
<style>
    .dropdown-submenu .dropdown-menu {
    display: none;
    }

    /* Show submenu when .show is applied */
    .dropdown-submenu .dropdown-menu.show {
        display: block;
    }

    /* Default behavior: Submenu appears below */
    .dropdown-submenu .dropdown-menu {
        left: 0;
        top: 100%; /* Places it below */
    }

/* On small screens (<768px), keep dropdowns inline */
@media (max-width: 767px) {
    .dropdown-submenu .dropdown-menu {
        left: 100%;
        top: 0;
    }
}

    @media (max-width: 991.98px) {
        /* Slide-in navbar from the right on small screens */
        .navbar-collapse {
            position: fixed;
            top: 0;
            right: -100%;
            height: 100vh;
            width: 75%;
            max-width: 250px;
            background: white;
            transition: right 0.3s ease-in-out;
            box-shadow: -2px 0 5px rgba(0, 0, 0, 0.2);
            padding-top: 20px;
            z-index: 1050;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
        }

        /* When navbar is open */
        .navbar-collapse.show {
            right: 0;
        }

        /* Close button styling */
        .close-nav {
            position: absolute;
            top: 10px;
            right: 15px;
            font-size: 24px;
            background: none;
            border: none;
            cursor: pointer;
            display: block;
        }

        /* Horizontal dividers for nav-items */
        .nav-item {
            padding-bottom: 12px;
            width: 100%;
            border-bottom: 1px solid #ccc;
            position: relative;
            transition: padding-bottom 0.3s ease;
        }

        /* Remove border from last nav-item */
        .nav-item:last-child {
            border-bottom: none;
        }

        /* Add single angle quote before each nav-item */
        .nav-item a::before {
            content: 'â€º';
            color: green;
            margin-right: 8px;
            font-weight: bold;
            font-size: 1.2rem;
        }

        /* Center align nav-items */
        .navbar-nav {
            width: 100%;
            display: flex;
            flex-direction: column;
            align-items: start;
            justify-content: center;
        }

        .nav-link {
            display: flex;
            justify-content: center;
            align-items: center;
            width: 100%;
        }

        /* Adjust SVG size */
        .nav-link img {
            width: 20px;
            height: 20px;
        }
    }


    /* Style for "Get a Quote" Button */
    .curved-button {
        background-color: green;
        color: white;
        padding: 10px;
        border: 1px solid #444444;
        border-radius: 30px;
        font-size: 13px;
        cursor: pointer;
        transition: background-color 0.3s ease;
    }


    /* Large Screens Styling */
    @media (min-width: 992px) {
        .close-nav {
            display: none; /* Hide close button */
        }

        /* Center navbar-nav */
        .navbar-nav {
            width: 100%;
            display: flex;
            flex-direction: row;
            align-items: center;
            justify-content: center; /* Center the nav items */
        }

        /* Ensure "Get a Quote" button stays aligned to the right */
        .quote-btn-container {
            margin-top: 0;
            text-align: right;
            width: auto;
        }

        .nav-link img {
            width: 0;
            height: 0;
        }
    }


    /* Green shadow around navbar-toggler */
    .navbar-toggler {
        border-radius: 5px;
        transition: all 0.3s ease-in-out;
    }

    /* Change background color of navbar-toggler when clicked */
    .navbar-toggler:focus,
    .navbar-toggler:active {
        box-shadow: 0 0 12px green !important;
        outline: none;
    }

</style>
<script>
    document.addEventListener("DOMContentLoaded", function () {
    let dropdowns = document.querySelectorAll(".dropdown-submenu > a");

    dropdowns.forEach(function (dropdown) {
        dropdown.addEventListener("click", function (e) {
            e.preventDefault();
            e.stopPropagation();

            let submenu = this.nextElementSibling;
            if (submenu) {
                submenu.classList.toggle("show");
            }
        });
    });

    document.addEventListener("click", function (e) {
        let openSubmenus = document.querySelectorAll(".dropdown-menu.show");
        openSubmenus.forEach(function (submenu) {
            if (!submenu.parentElement.contains(e.target)) {
                submenu.classList.remove("show");
            }
            });
        });
    });
</script>